<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>格式化函數調試</title>
</head>
<body>
    <h1>格式化函數調試</h1>
    <button onclick="testFormats()">測試所有格式</button>
    <div id="results"></div>

    <script>
        function testFormats() {
            const testCases = [
                "2025-09-19 14:29:15+00",
                "2025-09-19T14:29:15.000Z",
                "2025-09-19T22:29:15+08:00",
                new Date().toISOString(),
                new Date(Date.now() - 5 * 60 * 1000).toISOString(), // 5分鐘前
            ];
            
            let results = '<h2>測試結果</h2>';
            
            testCases.forEach((testTime, index) => {
                results += `<h3>測試 ${index + 1}: ${testTime}</h3>`;
                
                try {
                    // 測試原始 new Date() 解析
                    const directParse = new Date(testTime);
                    results += `<p>直接解析: ${directParse.toString()}</p>`;
                    results += `<p>是否有效: ${!isNaN(directParse.getTime())}</p>`;
                    
                    if (!isNaN(directParse.getTime())) {
                        const now = new Date();
                        const diffMins = Math.floor((now - directParse) / (1000 * 60));
                        results += `<p>時間差: ${diffMins} 分鐘</p>`;
                        
                        let formatted;
                        if (diffMins < 1) formatted = '剛剛';
                        else if (diffMins < 60) formatted = `${diffMins}分鐘前`;
                        else formatted = `${Math.floor(diffMins / 60)}小時前`;
                        
                        results += `<p><strong>格式化結果: ${formatted}</strong></p>`;
                    }
                    
                } catch (error) {
                    results += `<p style="color: red;">錯誤: ${error.message}</p>`;
                }
                
                results += '<hr>';
            });
            
            document.getElementById('results').innerHTML = results;
        }
        
        // 自動測試
        window.onload = testFormats;
    </script>
</body>
</html>
