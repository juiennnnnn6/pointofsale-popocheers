# IP限制設定說明

## 當前IP限制設定

### ⚠️ IP限制已取消

系統目前設定為**允許所有IP地址訪問**：

- **狀態**: IP限制已停用
- **訪問控制**: 所有IP都可以訪問系統
- **安全性**: 降低（建議在需要時重新啟用）

### 預設設定

1. **通配符IP**: `*`
   - 描述：允許所有IP（IP限制已取消）
   - 狀態：啟用

2. **本地開發IP**:
   - `127.0.0.1` - 本地測試
   - `localhost` - 本地主機
   - `::1` - IPv6本地地址

### 地理位置限制

- **狀態**: 已取消
- **所有國家**: 允許訪問

## 安全機制

### IP檢查流程

1. **獲取用戶IP**: 使用外部服務獲取訪問者IP地址
2. **IP白名單檢查**: 檢查IP是否在允許列表中
3. **地理位置檢查**: 檢查用戶所在國家是否允許
4. **訪問控制**: 不符合條件則顯示拒絕頁面

### 錯誤處理

- **無法獲取IP**: 允許訪問（避免誤擋）
- **IP服務失敗**: 允許訪問（容錯機制）
- **地理位置服務失敗**: 允許訪問（容錯機制）

## 管理功能

### IP管理頁面

訪問路徑：登入後 → IP安全管理

功能包括：
- ✅ 查看當前IP白名單
- ✅ 新增/刪除IP地址
- ✅ 啟用/停用IP限制
- ✅ 測試當前IP
- ✅ 匯出IP清單

### 如何添加新IP

1. 登入系統（需要管理員權限）
2. 進入「IP安全管理」頁面
3. 點擊「新增IP」按鈕
4. 選擇IP類型（單一IP或IP範圍）
5. 輸入IP地址和描述
6. 設定啟用狀態
7. 儲存設定

## 測試方法

### 測試當前IP

1. 在IP管理頁面點擊「測試當前IP」
2. 查看當前IP和地理位置信息
3. 確認IP是否在允許列表中

### 測試訪問限制

1. 使用允許的IP訪問系統
2. 使用不允許的IP訪問系統
3. 檢查是否正確顯示拒絕頁面

## 故障排除

### 常見問題

**Q: 無法訪問系統怎麼辦？**
A: 檢查您的IP是否在允許列表中，或聯繫管理員添加您的IP。

**Q: 如何知道我的IP地址？**
A: 在IP管理頁面點擊「測試當前IP」按鈕。

**Q: 可以臨時關閉IP限制嗎？**
A: 可以，在IP管理頁面停用所有IP限制，但不建議在生產環境中這樣做。

**Q: 如何添加辦公室IP範圍？**
A: 在新增IP時選擇「IP範圍」類型，輸入CIDR格式（如：192.168.1.0/24）。

## 安全建議

1. **定期檢查**: 定期檢查IP白名單
2. **備份設定**: 定期匯出IP清單作為備份
3. **監控訪問**: 關注異常訪問記錄
4. **更新IP**: 及時更新員工IP地址

## 技術細節

### IP檢查服務

- **主要服務**: `https://api.ipify.org`
- **備用服務**: `https://httpbin.org/ip`
- **地理位置服務**: `https://ipapi.co`

### 緩存機制

- **sessionStorage**: 避免重複IP檢查
- **localStorage**: 儲存IP白名單設定

---

**注意**: IP限制已取消，所有IP都可以訪問系統。如需重新啟用IP限制，請在IP管理頁面進行設定。 